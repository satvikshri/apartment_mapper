<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Apartment Mapper</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: sans-serif; }
    #map { height: 100vh; }

    #form-container {
      position: absolute;
      top: 50px;
      left: 10px;
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.15);
      z-index: 1000;
      width: 300px;
      max-width: 90vw;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    #form-container.collapsed {
      transform: scaleY(0);
      transform-origin: top;
      opacity: 0;
      height: 0;
      padding: 0 15px;
      overflow: hidden;
    }

    #form-toggle-btn {
      position: absolute;
      top: 10px;
      left: 10px;
      width: 300px;
      max-width: 90vw;
      background: white;
      color: #333;
      border: 1px solid #ccc;
      padding: 6px;
      font-size: 14px;
      border-radius: 10px;
      cursor: pointer;
      z-index: 1100;
      box-shadow: 0 2px 10px rgba(0,0,0,0.15);
    }

    input, textarea, button {
      width: 100%;
      padding: 6px;
      margin-bottom: 10px;
      font-size: 14px;
    }

    .popup-img {
      width: 100%;
      max-height: 150px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 4px;
      display: block;
    }

    .popup-controls {
      margin-top: 8px;
      display: flex;
      justify-content: space-between;
    }

    .popup-controls button {
      font-size: 12px;
      padding: 4px 6px;
    }
  </style>
</head>
<body>

<button id="form-toggle-btn" onclick="toggleForm()">Hide</button>

<div id="form-container">
  <h3 id="form-title">Add Apartment</h3>
  <input id="name" placeholder="Apartment Name" required />
  <input id="coordinates" placeholder="Latitude, Longitude" required />
  <input id="rent" placeholder="Rent Info and map link" required />
  <input id="contact" placeholder="Contact Number" required />
  <input id="images" type="file" multiple accept="image/*" />
  <button onclick="submitForm()" id="submit-button">Add Apartment</button>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwxSJSfQkTrBJgWxh-9HxtxHu2u9gQ-qPlB9nEAQESJLVdNrMHtS9qJJIQiV9urfrTX/exec';
  const map = L.map('map').setView([12.97, 77.59], 12);
  let editingMarker = null;
  let markers = [];

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  const officeIcon = L.icon({
    iconUrl: 'https://cdn-icons-png.flaticon.com/512/684/684908.png',
    iconSize: [32, 32],
    iconAnchor: [16, 32],
    popupAnchor: [0, -32]
  });

  L.marker([12.98298220331369, 77.69162642844404], { icon: officeIcon })
    .addTo(map)
    .bindPopup('<strong>My Office</strong>');

  function toggleForm() {
    const form = document.getElementById('form-container');
    const btn = document.getElementById('form-toggle-btn');
    form.classList.toggle('collapsed');
